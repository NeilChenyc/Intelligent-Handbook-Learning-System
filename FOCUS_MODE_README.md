# 学习专注模式功能实现

## 功能概述

为在线学习平台新增了学习专注模式功能，包含番茄工作法计时器、学习时长统计和专注度分析。

## 技术实现

### 1. FocusTimer.jsx 专注计时器组件

- **番茄工作法实现**：25分钟专注 + 5分钟休息模式
- **自定义时长设置**：支持15/25/45分钟三种专注时长
- **可视化界面**：
  - 倒计时显示（格式：MM:SS）
  - 动态进度条（专注模式：蓝色渐变，休息模式：绿色渐变）
  - 模式指示器（专注/休息状态显示）
- **交互控制**：
  - 开始/暂停按钮
  - 重置按钮
  - 时长切换按钮（仅在未开始时可用）
- **提醒功能**：
  - 计时结束时播放音频提醒
  - 桌面通知功能（需用户授权）

### 2. FocusStats.jsx 学习统计面板

集成在计时器组件中，可展开/收起：

- **多维度统计**：
  - 今日专注时长（分钟）
  - 本周专注时长（分钟）
  - 本月专注时长（分钟）
  - 连续专注天数
  - 平均每天专注时长（分钟）
- **数据可视化**：网格布局展示统计数据，数值突出显示

### 3. AuthContext.jsx 扩展

- **状态管理**：
  - 添加 `focusHistory` 状态存储专注历史记录
  - 使用 `useReducer` 管理复杂状态逻辑
- **专注模式相关方法**：
  - `addFocusSession`: 添加专注会话记录
  - `getFocusHistory`: 获取过滤后的专注历史
  - `getFocusStats`: 计算并返回统计数据
- **数据结构**：专注会话记录包含 `userId`, `duration`, `timestamp`, `completed`

### 4. 数据持久化

- **localStorage 存储**：
  - 用户登录时加载对应ID的专注历史
  - 专注会话完成时自动保存到本地存储
  - 数据格式：`focusHistory_${userId}` 作为存储键
- **数据完整性**：
  - 登录时验证数据格式
  - 异常情况自动清理无效数据

### 5. 应用集成

- **全局悬浮组件**：固定在页面右上角（top: 100px, right: 20px）
- **条件显示**：仅当用户登录时显示专注模式组件
- **样式设计**：现代化卡片设计，包含阴影和悬停效果

## 使用说明

1. **启动专注模式**：
   - 点击「开始」按钮启动计时器
   - 选择不同时长（15/25/45分钟）
2. **查看统计数据**：
   - 点击「查看统计」按钮展开统计面板
   - 查看今日、本周、本月的专注时长统计
   - 查看连续专注天数和平均时长
3. **休息模式**：
   - 专注时长结束后自动进入5分钟休息模式
   - 休息结束后自动提醒开始新的专注任务
4. **通知设置**：
   - 首次使用时会请求桌面通知权限
   - 授权后计时结束会显示桌面通知

## 代码结构

```
src/
├── components/
│   └── FocusTimer.jsx       # 专注计时器和统计面板组件
├── contexts/
│   └── AuthContext.jsx       # 扩展后的认证上下文，包含专注模式状态管理
└── App.jsx                   # 主应用集成专注模式组件
```

## 关键特性

- **用户体验优化**：响应式设计，悬浮于所有页面之上
- **数据持久化**：本地存储确保数据不丢失
- **多维度统计**：帮助用户了解学习习惯和效率
- **提醒功能**：音频和桌面通知双重提醒
- **隐私保护**：数据仅存储在本地，不会上传到服务器

## 后续优化建议

1. **更多统计维度**：添加专注效率分析、任务完成率等
2. **个性化设置**：允许用户自定义专注/休息时长
3. **任务关联**：支持将专注时间与具体课程/任务关联
4. **数据导出**：支持将专注历史导出为 CSV 或其他格式
5. **成就系统**：添加专注时长里程碑和徽章奖励